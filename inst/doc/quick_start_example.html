<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Quick Start Example</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quick Start Example</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(abn)</span></code></pre></div>
<p>This vignette covers the whole process of Bayesian network structure
learning to parameter estimation and data simulation. # Find the best
fitting graphical structure using an exact search algorithm</p>
<div id="basic-workflow-with-the-abn-package" class="section level2">
<h2>Basic workflow with the <code>abn</code> package</h2>
<p>The package <code>abn</code> is a collection of functions for
modelling of additive Bayesian networks. It contains routines to score
Bayesian Networks based on Bayesian (default) or information-theoretic
formulation of generalized linear models. Depending on the type of data,
the package supports a possible mixture of continuous, discrete, and
count data. The following table shows which of distribution types are
supported by for each method of estimation:</p>
<table>
<thead>
<tr class="header">
<th align="left">Distribution type</th>
<th align="center"><code>method = &quot;bayes&quot;</code></th>
<th align="center"><code>method = &quot;mle&quot;</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Gaussian</td>
<td align="center">✅</td>
<td align="center">✅</td>
</tr>
<tr class="even">
<td align="left">Binomial</td>
<td align="center">✅</td>
<td align="center">✅</td>
</tr>
<tr class="odd">
<td align="left">Poisson</td>
<td align="center">✅</td>
<td align="center">✅</td>
</tr>
<tr class="even">
<td align="left">Multinomial</td>
<td align="center">❌</td>
<td align="center">✅</td>
</tr>
</tbody>
</table>
<p>Structure learning of additive Bayesian networks with
<code>abn</code> is a three-step process. Based on a set of model
specifications (data, maximal number of possible parent nodes,
restricted or enforced arcs, etc.), <code>abn</code> calculates in a
first step the score of the data given the model
(<code>buildScoreCache()</code>). This list of scores is then used to
estimate the most probable Bayesian network structure (“structure
learning”) and to infer the network structure in a third step
(<code>fitAbn()</code>). Four structure-learning algorithms have been
implemented in <code>abn</code>: the hill-climbing algorithm, the “exact
search” algorithm, the simulated annealing algorithm and tabu search
algorithm. With the network structure inferred, the package provides
routines to estimate the parameters of the network and to simulate data
from the fitted additive Bayesian network model.</p>
<p>The following example shows how to find the best fitting graphical
structure using an exact search algorithm.</p>
</div>
<div id="model-specification" class="section level2">
<h2>Model specification</h2>
<div id="load-the-example-dataset-ex1.dag.data" class="section level3">
<h3>Load the example dataset <code>ex1.dag.data</code></h3>
<p>This artificial data set comes with <code>abn</code> and contains
10000 observations of 10 variables. The variables are a mixture of
continuous (<code>gaussian</code>), binary (<code>binomial</code>), and
count (<code>poisson</code>) data. The data set is a simulated data set
from a known network structure.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>mydat <span class="ot">&lt;-</span> ex1.dag.data</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">str</span>(mydat)</span></code></pre></div>
</div>
<div id="set-up-distribution-list-for-each-node" class="section level3">
<h3>Set up distribution list for each node</h3>
<p><code>abn</code> requires a list of the type of distribution for each
node in the data set.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mydists <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">b1=</span><span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                <span class="at">p1=</span><span class="st">&quot;poisson&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                <span class="at">g1=</span><span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                <span class="at">b2=</span><span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                <span class="at">p2=</span><span class="st">&quot;poisson&quot;</span>, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                <span class="at">b3=</span><span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                <span class="at">g2=</span><span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                <span class="at">b4=</span><span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                <span class="at">b5=</span><span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                <span class="at">g3=</span><span class="st">&quot;gaussian&quot;</span>) </span></code></pre></div>
</div>
<div id="set-the-parent-limits-node-wise" class="section level3">
<h3>Set the parent limits node-wise</h3>
<p>The <code>max.par</code> argument sets the maximum number of parent
nodes for each node in the data set. It can be set to a single value for
all nodes or to a list with the node names as keys and the maximum
number of parent nodes as values. This is a crucial parameter to speed
up the model estimation in <code>abn</code> as it limits the number of
possible combinations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># max.par &lt;- list(&quot;b1&quot;=1,&quot;p1&quot;=2,&quot;g1&quot;=3,&quot;b2&quot;=4,&quot;p2&quot;=1,&quot;b3&quot;=2,&quot;g2&quot;=3,&quot;b4&quot;=4,&quot;b5&quot;=1,&quot;g3&quot;=2) # set different max parents for each node</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>max.par <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># set the same max parents for all nodes</span></span></code></pre></div>
</div>
</div>
<div id="build-the-score-cache" class="section level2">
<h2>Build the score cache</h2>
<p>The score cache is a list of scores for each possible parent
combination for each node in the data set. It is used to learn the
structure of the Bayesian network in the next step.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mycache <span class="ot">&lt;-</span> <span class="fu">buildScoreCache</span>(<span class="at">data.df =</span> mydat, </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                           <span class="at">data.dists =</span> mydists,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;bayes&quot;</span>, <span class="co"># the default method is &quot;bayes&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                           <span class="at">max.parents =</span> max.par)</span></code></pre></div>
<p>The minimal number of input arguments for
<code>buildScoreCache()</code> is the data set and the distribution
list. By default, the function uses the Bayesian score which is based on
the posterior probability of the model given the data. To use the
Log-Likelihood score, Akaike Information Criterion (AIC) or Bayesian
Information Criterion (BIC) instead, the <code>method</code> argument
can be set to <code>&quot;mle&quot;</code>.</p>
<p>The function <code>buildScoreCache()</code> also accepts a list of
banned and retained arcs, which can be used to enforce or restrict the
presence of certain arcs in the network structure. This can be useful if
prior knowledge about the network structure is available, e.g. from
expert knowledge or from previous analyses it is known that certain arcs
must be present or have to be absent.</p>
<p>The <code>max.parents</code> argument sets the maximum number of
parent nodes for each node in the data set and together with the
<code>dag.banned</code> and <code>dag.retained</code> arguments, it
restricts the model search space and can speed up the model estimation
in <code>abn</code>.</p>
</div>
<div id="structure-learning" class="section level2">
<h2>Structure learning</h2>
<p>The next step is to find the best fitting graphical structure of the
Bayesian network. In this example, we use the exact search algorithm to
find the most probable Bayesian network structure given the score cache
from the previous step. We supply the score cache as
<code>abnCache</code> object from the previous step to the structure
learning function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>mp.dag <span class="ot">&lt;-</span> <span class="fu">mostProbable</span>(<span class="at">score.cache =</span> mycache)</span></code></pre></div>
<p>The <code>mostProbable()</code> function returns an object of class
<code>abnLearned</code> which contains the most probable Bayesian
network structure and the score of the model given the data.</p>
<div id="plot-the-best-fitting-graphical-structure" class="section level3">
<h3>Plot the best fitting graphical structure</h3>
<p>The best fitting graphical structure can be plotted using the
<code>plotAbn()</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(mp.dag)</span></code></pre></div>
<p>The <code>plot()</code> function requires the <code>Rgraphviz</code>
package to be installed.</p>
</div>
</div>
<div id="estimate-the-parameters-of-the-network" class="section level2">
<h2>Estimate the parameters of the network</h2>
<p>The parameters of the network can be estimated using the
<code>fitAbn()</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>myfit <span class="ot">&lt;-</span> <span class="fu">fitAbn</span>(<span class="at">object =</span> mp.dag)</span></code></pre></div>
<p>The <code>fitAbn()</code> function returns an object of class
<code>abnFit</code> which contains the estimated parameters of the
network.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(myfit)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">plot</span>(myfit)</span></code></pre></div>
</div>
<div id="simulate-data-from-the-fitted-model" class="section level2">
<h2>Simulate data from the fitted model</h2>
<p>The <code>simulateAbn()</code> function can be used to simulate data
from the fitted model.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">simulateAbn</span>(<span class="at">object =</span> myfit, </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                      <span class="at">n.iter =</span> <span class="dv">10000</span><span class="dt">L</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">summary</span>(simdat)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
